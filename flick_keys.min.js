((function(){var a,b,c,d,e,f,g,h,i,j;this.flickKeys={sound:!0},flickKeys.isPushed=function(a){return a.model!=null&&a.model.state===e},h={source:new Audio("sounds/click.aiff"),play:function(){if(!flickKeys.sound)return;return this.source.play(),h.timer=setTimeout(function(){h.source.pause();try{return h.source.currentTime=0}catch(a){}},30)}},a=function(){function a(a,b,c){this.state=a,this.observer=b,this.holdTime=c}return a.prototype.setState=function(a){return this.state=a,this.changed()},a.prototype.subkey=function(){var a;return(a=this.observer.childNodes[1])!=null?a:null},a.prototype.changed=function(){return this.state.update(this.observer,this.subkey())},a.prototype.clearTimer=function(){return this.timer!=null&&clearTimeout(this.timer),this.timer=null},a.prototype.touchStart=function(a,b){var d,f=this;return this.startX=a,this.startY=b,setTimeout(function(){return h.source.play()},0),this.setState(e),this.subkey()!=null&&(this.timer=setTimeout(function(){return f.setState(i)},this.holdTime)),c("keydown",(d=this.observer.dataset.keyid)!=null?d:"",this.keyCode(),0)},a.prototype.touchMove=function(a){var b,c,d;return d=a.targetTouches[0],b=d.pageX-this.startX,c=d.pageY-this.startY,this.state.touchMove(this,b,c)},a.prototype.touchEnd=function(){var a;return this.state.touchEnd(this),c("keyup",(a=this.observer.dataset.keyid)!=null?a:"",this.keyCode(),0)},a.prototype.keyCode=function(){var a,b;return b=this.observer.dataset.keyid,b!=null?a=f[b]:this.observer.title!=null?(a=this.observer.title.charCodeAt(0),a<=46&&(a=0)):a=0,a},a}(),b=function(){function a(){}return a.prototype.update=function(a,b){},a.prototype.touchMove=function(a,b,c){},a.prototype.touchEnd=function(a){},a.prototype.inRange=function(a,b){var c;return c=$(".key").width(),-c<a&&a<c&&-2*c<b&&b<c},a}(),g=new b,g.update=function(a,b){if(b!=null)return b.style.display="none"},e=new b,e.update=function(a,b){return a.style.backgroundColor="#a0a0a0"},e.touchMove=function(a,b,c){var d;d=30;if(a.subkey()!=null&&c<-d&&-d<b&&b<d)return a.clearTimer(),a.setState(i);if(!this.inRange(b,c))return a.clearTimer(),a.setState(g)},e.touchEnd=function(a){var b;return a.clearTimer(),a.observer.title!=null&&a.observer.title!==""&&(b=a.observer.title.charCodeAt(0),d(a.observer.title),c("keypress",b,b)),a.setState(g)},i=new b,i.update=function(a,b){return $(b).css("color","#fff"),$(b).css("background-image","-webkit-gradient(linear, left top, left bottom, from(rgb(65,134,245)), to(rgb(25,79,220)))"),b.style.display="block"},i.touchMove=function(a,b,c){if(!this.inRange(b,c))return a.setState(j)},i.touchEnd=function(a){var b;return a.subkey().title!=null&&a.subkey().title!==""&&(b=a.subkey().title.charCodeAt(0),d(a.subkey().title),c("keypress",b,b)),a.setState(g)},j=new b,j.update=function(a,b){return $(b).css("color","#000"),$(b).css("background-image","-webkit-gradient(linear, left top, left bottom, from(#EEEEF0), to(#D2D2D8))")},j.touchMove=function(a,b,c){if(this.inRange(b,c))return a.setState(i)},j.touchEnd=function(a){return a.setState(g)},f={Control:17,Alt:18,Meta:91,Left:37,Right:39,Up:38,Home:36,PageUp:33,"U+0009":9,Down:40,End:35,PageDown:34,Shift:16},KeyboardEvent.DOM_KEY_LOCATION_STANDARD=0,c=function(a,b,c,d){var e;return e=document.createEvent("KeyboardEvent"),e.initKeyboardEvent(a,!0,!0,window,b,KeyboardEvent.DOM_KEY_LOCATION_STANDARD,""),e.override={keyCode:c,charCode:d},document.activeElement.dispatchEvent(e)},TextEvent.DOM_INPUT_METHOD_KEYBOARD=1,TextEvent.DOM_INPUT_METHOD_PASTE=2,d=function(a,b){var c;return b==null&&(b=TextEvent.DOM_INPUT_METHOD_KEYBOARD),c=document.createEvent("TextEvent"),c.initTextEvent("textInput",!0,!0,window,a,TextEvent.DOM_INPUT_METHOD_KEYBOARD),document.activeElement.dispatchEvent(c)},flickKeys.initialize=function(){return $(".key.main").mousedown(function(a){return a.preventDefault()}),$(".key.main").live("touchstart",function(b){var c;return c=b.originalEvent.targetTouches[0],this.model==null&&(this.model=new a(g,this,400)),this.model.touchStart(c.pageX,c.pageY)}),$(".key.main").live("touchmove",function(a){return this.model.touchMove(a.originalEvent),a.preventDefault()}),$(".key.main").live("touchend",function(a){return this.model.touchEnd()})}})).call(this);